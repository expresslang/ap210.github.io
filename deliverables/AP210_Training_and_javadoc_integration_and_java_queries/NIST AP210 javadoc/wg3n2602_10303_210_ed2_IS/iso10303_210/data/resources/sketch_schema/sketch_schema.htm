
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
   <HEAD>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <TITLE>Integrated Resource: sketch_schema</TITLE>
   </HEAD>
   <body>
      <h2>Schema: sketch_schema</h2>
      <p><i>Source : ISO 10303-108</i></p><code><br><br><a name="sketch_schema">SCHEMA <b>sketch_schema</b>;</a><br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/product_property_representation_schema/product_property_representation_schema.htm#product_property_representation_schema">product_property_representation_schema</A>&nbsp;&nbsp;&nbsp;-- ISO 10303-41<br>&nbsp;&nbsp;(<A HREF="../../../data/resources/product_property_representation_schema/product_property_representation_schema.htm#product_property_representation_schema.shape_representation">shape_representation</A>);
         <br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema">geometry_schema</A>;
         &nbsp;&nbsp;&nbsp;-- ISO 10303-42<br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/topology_schema/topology_schema.htm#topology_schema">topology_schema</A>&nbsp;&nbsp;&nbsp;-- ISO 10303-42<br>&nbsp;&nbsp;(<A HREF="../../../data/resources/topology_schema/topology_schema.htm#topology_schema.face_surface">face_surface</A>);
         <br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/geometric_model_schema/geometric_model_schema.htm#geometric_model_schema">geometric_model_schema</A>&nbsp;&nbsp;&nbsp;-- ISO 10303-42<br>&nbsp;&nbsp;(<A HREF="../../../data/resources/geometric_model_schema/geometric_model_schema.htm#geometric_model_schema.solid_model">solid_model</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/geometric_model_schema/geometric_model_schema.htm#geometric_model_schema.surface_model">surface_model</A>);
         <br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema">representation_schema</A>&nbsp;&nbsp;&nbsp;-- ISO 10303-43<br>&nbsp;&nbsp;(<A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.item_in_context">item_in_context</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.mapped_item">mapped_item</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation">representation</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_item_relationship">representation_item_relationship</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_map">representation_map</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.using_items">using_items</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.using_representations">using_representations</A>);
         <br><br></code><code>
         REFERENCE FROM 
         <A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema">variational_representation_schema</A>&nbsp;&nbsp;&nbsp;-- ISO 10303-108<br>&nbsp;&nbsp;(<A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.auxiliary_geometric_representation_item">auxiliary_geometric_representation_item</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.variational_representation">variational_representation</A>,<br>
         &nbsp;&nbsp;
         <A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.variational_representation_item">variational_representation_item</A>);
         <br><br></code><code><br><A NAME="sketch_schema.curves_or_area">TYPE </A><b>curves_or_area</b> =
         
         ENUMERATION
         
         OF
         <br>
         &nbsp;&nbsp; 
         (curves,<br>&nbsp;&nbsp;&nbsp;&nbsp;area);<br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.planar_curve_select">TYPE </A><b>planar_curve_select</b> =
         
         
         SELECT<br>
         &nbsp;&nbsp;&nbsp;(<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.conic">conic</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.line">line</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.pcurve">pcurve</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.surface_curve">surface_curve</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.trimmed_curve">trimmed_curve</A>);<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.planar_curve_select.wr:wr1">WR1: SELF\geometric_representation_item.dim = 3;</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.planar_curve_select.wr:wr2">WR2: check_curve_planarity(SELF);</A><br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.sketch_basis_select">TYPE </A><b>sketch_basis_select</b> =
         
         
         SELECT<br>
         &nbsp;&nbsp;&nbsp;(<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve_bounded_surface">curve_bounded_surface</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/topology_schema/topology_schema.htm#topology_schema.face_surface">face_surface</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.planar_curve_select">planar_curve_select</A>);<br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.sketch_element_select">TYPE </A><b>sketch_element_select</b> =
         
         EXTENSIBLE
         
         
         SELECT<br>
         &nbsp;&nbsp;&nbsp;(<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.point">point</A>);<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.sketch_element_select.wr:wr1">WR1: 'GEOMETRY_SCHEMA.GEOMETRIC_REPRESENTATION_ITEM' IN TYPEOF(SELF);</A><br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.sketch_type_select">TYPE </A><b>sketch_type_select</b> =
         
         
         SELECT<br>
         &nbsp;&nbsp;&nbsp;(<A HREF="#sketch_schema.neutral_sketch_representation">neutral_sketch_representation</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.positioned_sketch">positioned_sketch</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.subsketch">subsketch</A>);<br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.surface_or_solid_model">TYPE </A><b>surface_or_solid_model</b> =
         
         
         SELECT<br>
         &nbsp;&nbsp;&nbsp;(<A HREF="../../../data/resources/geometric_model_schema/geometric_model_schema.htm#geometric_model_schema.solid_model">solid_model</A>, <br>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="../../../data/resources/geometric_model_schema/geometric_model_schema.htm#geometric_model_schema.surface_model">surface_model</A>);<br>
         END_TYPE; 
         <br></code><code><br><A NAME="sketch_schema.implicit_explicit_positioned_sketch_relationship">ENTITY <b>implicit_explicit_positioned_sketch_relationship</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_item_relationship">representation_item_relationship</A>);<br>
         &nbsp;&nbsp;SELF\<A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_item_relationship">representation_item_relationship</A>.<A NAME="sketch_schema.implicit_explicit_positioned_sketch_relationship.relating_representation_item">relating_representation_item : </A><A HREF="#sketch_schema.repositioned_neutral_sketch">repositioned_neutral_sketch</A>;<br>
         &nbsp;&nbsp;SELF\<A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_item_relationship">representation_item_relationship</A>.<A NAME="sketch_schema.implicit_explicit_positioned_sketch_relationship.related_representation_item">related_representation_item : </A><A HREF="#sketch_schema.positioned_sketch">positioned_sketch</A>;<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_explicit_positioned_sketch_relationship.wr:wr1">WR1: SIZEOF(QUERY(q &lt;* using_representations(
            SELF\representation_item_relationship.related_representation_item) |
            item_in_context(
            SELF\representation_item_relationship.relating_representation_item,
            q.context_of_items))) &gt; 0;</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_intersection_curve">ENTITY <b>implicit_intersection_curve</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_planar_curve">implicit_planar_curve</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_intersection_curve.external_surface">external_surface : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.surface">surface</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_model_intersection_curve">ENTITY <b>implicit_model_intersection_curve</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_planar_curve">implicit_planar_curve</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_model_intersection_curve.intersected_model">intersected_model : </A><A HREF="#sketch_schema.surface_or_solid_model">surface_or_solid_model</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_planar_curve">ENTITY <b>implicit_planar_curve</b></A><br>
         &nbsp;&nbsp;ABSTRACT SUPERTYPE
         
         OF&nbsp;(ONEOF&nbsp;(<A HREF="#sketch_schema.implicit_intersection_curve">implicit_intersection_curve</A>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.implicit_projected_curve">implicit_projected_curve</A>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.implicit_model_intersection_curve">implicit_model_intersection_curve</A>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.implicit_silhouette_curve">implicit_silhouette_curve</A>))<br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.auxiliary_geometric_representation_item">auxiliary_geometric_representation_item</A>, <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_curve.using_sketch">using_sketch : </A><A HREF="#sketch_schema.positioned_sketch">positioned_sketch</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_curve.computed_representation">computed_representation : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>;<br>DERIVE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_curve.curve_plane">curve_plane : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.plane">plane</A> := get_plane_of_implicit_geometry(using_sketch);<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_curve.wr:wr1">WR1: SIZEOF(TYPEOF(computed_representation) * 
            ['SKETCH_SCHEMA.IMPLICIT_PLANAR_CURVE',
            'GEOMETRY_SCHEMA.CURVE_REPLICA']) = 0;</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_planar_intersection_point">ENTITY <b>implicit_planar_intersection_point</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_point_on_plane">implicit_point_on_plane</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_intersection_point.external_curve">external_curve : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_planar_projection_point">ENTITY <b>implicit_planar_projection_point</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_point_on_plane">implicit_point_on_plane</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_projection_point.external_point">external_point : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.point">point</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_planar_projection_point.projection_direction">projection_direction : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.direction">direction</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_point_on_plane">ENTITY <b>implicit_point_on_plane</b></A><br>
         &nbsp;&nbsp;ABSTRACT SUPERTYPE
         
         OF&nbsp;(ONEOF&nbsp;(<A HREF="#sketch_schema.implicit_planar_intersection_point">implicit_planar_intersection_point</A>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#sketch_schema.implicit_planar_projection_point">implicit_planar_projection_point</A>))<br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.auxiliary_geometric_representation_item">auxiliary_geometric_representation_item</A>, <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.point">point</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_point_on_plane.using_sketch">using_sketch : </A><A HREF="#sketch_schema.positioned_sketch">positioned_sketch</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_point_on_plane.computed_representation">computed_representation : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.cartesian_point">cartesian_point</A>;<br>DERIVE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_point_on_plane.plane_of_point">plane_of_point : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.plane">plane</A> := get_plane_of_implicit_geometry(using_sketch);<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_point_on_plane.wr:wr1">WR1: (plane_of_point\elementary_surface.position.location = 
            computed_representation) XOR
            (dot_product(plane_of_point\elementary_surface.position.p[3],
            get_relative_direction_2points
            (plane_of_point\elementary_surface.position.location, 
            computed_representation)) = 0);</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_point_on_plane.wr:wr2">WR2: SIZEOF(TYPEOF(computed_representation) * 
            ['SKETCH_SCHEMA.IMPLICIT_POINT_ON_PLANE',
            'GEOMETRY_SCHEMA.POINT_REPLICA']) = 0;</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_projected_curve">ENTITY <b>implicit_projected_curve</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_planar_curve">implicit_planar_curve</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_projected_curve.external_curve">external_curve : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_projected_curve.projection_direction">projection_direction : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.direction">direction</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.implicit_silhouette_curve">ENTITY <b>implicit_silhouette_curve</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.implicit_planar_curve">implicit_planar_curve</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_silhouette_curve.silhouetted_model">silhouetted_model : </A><A HREF="#sketch_schema.surface_or_solid_model">surface_or_solid_model</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.implicit_silhouette_curve.view_direction">view_direction : </A><A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.direction">direction</A>;<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.neutral_sketch_representation">ENTITY <b>neutral_sketch_representation</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/product_property_representation_schema/product_property_representation_schema.htm#product_property_representation_schema.shape_representation">shape_representation</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.neutral_sketch_representation.neutral_sketch_semantics">neutral_sketch_semantics : </A><A HREF="#sketch_schema.curves_or_area">curves_or_area</A>;<br>
         &nbsp;&nbsp;SELF\<A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation">representation</A>.<A NAME="sketch_schema.neutral_sketch_representation.items">items : </A>SET[1:?] OF <A HREF="#sketch_schema.sketch_element_select">sketch_element_select</A>;<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.neutral_sketch_representation.wr:wr1">WR1: SIZEOF(QUERY(q &lt;* SELF\representation.items | q.dim &lt;&gt; 2)) = 0;</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.positioned_sketch">ENTITY <b>positioned_sketch</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.geometric_representation_item">geometric_representation_item</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.sketch_basis">sketch_basis : </A><A HREF="#sketch_schema.sketch_basis_select">sketch_basis_select</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.auxiliary_elements">auxiliary_elements : </A>SET[0:?] OF <A HREF="../../../data/resources/variational_representation_schema/variational_representation_schema.htm#variational_representation_schema.auxiliary_geometric_representation_item">auxiliary_geometric_representation_item</A>;<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.wr:wr1">WR1: NOT (('GEOMETRY_SCHEMA.CURVE_BOUNDED_SURFACE' IN 
            TYPEOF(sketch_basis)) AND NOT ('GEOMETRY_SCHEMA.PLANE' IN
            TYPEOF(sketch_basis.basis_surface)));</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.wr:wr2">WR2: NOT (('TOPOLOGY_SCHEMA.FACE_SURFACE' IN TYPEOF(sketch_basis)) AND
            NOT ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(sketch_basis.face_geometry)));</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.wr:wr3">WR3: SIZEOF(QUERY(q &lt;* auxiliary_elements | (SIZEOF(TYPEOF(q) * 
            ['GEOMETRY_SCHEMA.POINT','GEOMETRY_SCHEMA.CURVE']) = 0))) = 0;</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.positioned_sketch.wr:wr4">WR4: SIZEOF(QUERY(q &lt;* auxiliary_elements | 
            q\geometric_representation_item.dim &lt;&gt; 3)) = 0;</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.repositioned_neutral_sketch">ENTITY <b>repositioned_neutral_sketch</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.geometric_representation_item">geometric_representation_item</A>, <A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.mapped_item">mapped_item</A>);<br>DERIVE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.repositioned_neutral_sketch.map">map : </A><A HREF="../../../data/resources/representation_schema/representation_schema.htm#representation_schema.representation_map">representation_map</A> := SELF\mapped_item.mapping_source;<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.repositioned_neutral_sketch.wr:wr1">WR1: 'SKETCH_SCHEMA.NEUTRAL_SKETCH_REPRESENTATION'
            IN TYPEOF(map.mapped_representation);</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.repositioned_neutral_sketch.wr:wr2">WR2: 'GEOMETRY_SCHEMA.AXIS2_PLACEMENT_2D' IN 
            TYPEOF(map.mapping_origin);</A><br>
         &nbsp;&nbsp;<A NAME="sketch_schema.repositioned_neutral_sketch.wr:wr3">WR3: 'GEOMETRY_SCHEMA.AXIS2_PLACEMENT_3D' IN 
            TYPEOF(SELF\mapped_item.mapping_target);</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.rigid_subsketch">ENTITY <b>rigid_subsketch</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="#sketch_schema.subsketch">subsketch</A>);<br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.subsketch">ENTITY <b>subsketch</b></A><br>
         &nbsp;&nbsp;SUBTYPE OF (<A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.geometric_representation_item">geometric_representation_item</A>);<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.subsketch.subsketch_elements">subsketch_elements : </A>SET[1:?] OF <A HREF="#sketch_schema.sketch_element_select">sketch_element_select</A>;<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.subsketch.owning_sketch">owning_sketch : </A><A HREF="#sketch_schema.sketch_type_select">sketch_type_select</A>;<br>WHERE<br>
         &nbsp;&nbsp;<A NAME="sketch_schema.subsketch.wr:wr1">WR1: (('SKETCH_SCHEMA.NEUTRAL_SKETCH_REPRESENTATION' 
            IN TYPEOF(owning_sketch)) AND (SIZEOF(QUERY(q &lt;* 
            subsketch_elements | NOT (owning_sketch IN 
            using_representations(q)))) = 0))
            XOR
            ((SIZEOF(TYPEOF(owning_sketch) *
            ['SKETCH_SCHEMA.POSITIONED_SKETCH','SKETCH_SCHEMA.SUBSKETCH']) = 1)
            AND 
            (SIZEOF(QUERY(q &lt;* subsketch_elements |
            NOT (owning_sketch IN using_items(q,[])))) = 0));</A><br>
         
         END_ENTITY;<br></code><code><br><A NAME="sketch_schema.check_curve_planarity">FUNCTION <b>check_curve_planarity</b></A><br>&nbsp;(checked_curve : <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.curve">curve</A>) : BOOLEAN;
         </code><pre>LOCAL
    crv    : curve   := checked_curve;
    i,j    : INTEGER;
    result : LOGICAL := UNKNOWN;
  END_LOCAL;

  -- Determine whether the curve lies on a plane, according to its type

  IF (SIZEOF(['GEOMETRY_SCHEMA.CONIC','GEOMETRY_SCHEMA.LINE'] *
    TYPEOF(crv)) &gt; 0) 
  THEN result := TRUE;
  ELSE
    IF (('GEOMETRY_SCHEMA.TRIMMED_CURVE' IN TYPEOF(crv)) 
      AND check_curve_planarity(crv.basis_curve))
    THEN result := TRUE;
    ELSE
      IF (('GEOMETRY_SCHEMA.PCURVE' IN TYPEOF(crv)) 
        AND ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(crv.basis_surface)))
      THEN result := TRUE;
      ELSE
        IF ('GEOMETRY_SCHEMA.SURFACE_CURVE' IN TYPEOF(crv)) 
        THEN
        BEGIN
          REPEAT j := 1 TO HIINDEX(crv.basis_surface);
            IF ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(crv.basis_surface[j])) 
            THEN result := TRUE;
            END_IF;
          END_REPEAT;
        END;
        END_IF;
      END_IF;
    END_IF;
  END_IF;

  RETURN(result);</pre><code>
         END_FUNCTION;
         </code><br><code><br><A NAME="sketch_schema.get_plane_of_implicit_geometry">FUNCTION <b>get_plane_of_implicit_geometry</b></A><br>&nbsp;(ps : <A HREF="../../../data/resources/sketch_schema/sketch_schema.htm#sketch_schema.positioned_sketch">positioned_sketch</A>) : <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.plane">plane</A>;
         </code><pre>LOCAL
    sb     : sketch_basis_select := ps.sketch_basis;
    result : plane := ?;
  END_LOCAL;

  -- determine plane of implicit geometry from the underlying entity data
  -- type of its owning instance of positioned_sketch_representation.  If
  -- the sketch basis is of type planar_curve_select then the planarity 
  -- of the curve is guaranteed by a WHERE rule on the SELECT type of that 
  -- name.

  IF ('TOPOLOGY_SCHEMA.FACE_SURFACE' IN TYPEOF(sb)) THEN 
    result := sb.face_geometry;
  ELSE
    IF ('GEOMETRY_SCHEMA.CURVE_BOUNDED_SURFACE' IN TYPEOF(sb)) THEN
      result := sb.basis_surface;
    ELSE 
      IF ('SKETCH_SCHEMA.PLANAR_CURVE_SELECT' IN TYPEOF(sb)) THEN
      BEGIN
 
        IF ('GEOMETRY_SCHEMA.CONIC' IN TYPEOF(sb)) 
          THEN result := dummy_gri || surface() || 
            elementary_surface(sb.position) || plane();
        END_IF;

        IF ('GEOMETRY_SCHEMA.TRIMMED_CURVE' IN TYPEOF(sb)) 
          THEN 
          BEGIN
            result := get_plane_of_implicit_geometry(
            dummy_gri || positioned_sketch(sb.basis_curve,[]));
          END;
        END_IF;

        IF ('GEOMETRY_SCHEMA.PCURVE' IN TYPEOF(sb))
          THEN result := sb.basis_surface;
        END_IF;

        IF ('GEOMETRY_SCHEMA.SURFACE_CURVE' IN TYPEOF(sb)) THEN
        BEGIN
          IF ((SIZEOF(sb.basis_surface) = 1) -- case of one basis surface 
            AND ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(sb.basis_surface[1])))
          THEN result := sb.basis_surface[1];
          ELSE -- case of two basis surfaces
            IF (('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(sb.basis_surface[1]))
              AND ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(sb.basis_surface[2])))
            THEN result := ?;
              -- both basis surfaces are planes, their intersection curve 
              -- is a line, and no unique plane is defined
            ELSE -- only one of the two basis surfaces is a plane
              IF ('GEOMETRY_SCHEMA.PLANE' IN TYPEOF(sb.basis_surface[1]))
              THEN result := sb.basis_surface[1];
              ELSE result := sb.basis_surface[2];
              END_IF;
            END_IF;
          END_IF;
        END;
        END_IF;
      END;
      END_IF;
    END_IF;
  END_IF;

  RETURN(result);</pre><code>
         END_FUNCTION;
         </code><br><code><br><A NAME="sketch_schema.get_relative_direction_2points">FUNCTION <b>get_relative_direction_2points</b></A><br>&nbsp;(cp1 : <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.cartesian_point">cartesian_point</A>; cp2 : <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.cartesian_point">cartesian_point</A>) : <A HREF="../../../data/resources/geometry_schema/geometry_schema.htm#geometry_schema.direction">direction</A>;
         </code><pre>LOCAL
    d1, d2, d3, magnitude : REAL;
    result                : direction := ?;  
  END_LOCAL;

  -- check that input points are three-dimensional

  IF ((cp1.dim &lt;&gt; 3) OR (cp2.dim &lt;&gt; 3)) THEN 
    RETURN(result);
  ELSE

    -- construct components of vector and compute its magnitude

    BEGIN
      d1 := cp2.coordinates[1] - cp1.coordinates[1];
      d2 := cp2.coordinates[2] - cp1.coordinates[2];
      d3 := cp2.coordinates[3] - cp1.coordinates[3];
      magnitude := sqrt(d1*d1 + d2*d2 + d3*d3);
      IF (magnitude = 0) THEN 
        return(result); -- direction is indeterminate in this case
      END_IF;
      result := dummy_gri || direction([d1, d2, d3]);
    END;
  END_IF;
  RETURN(result);</pre><code>
         END_FUNCTION;
         </code><br><code><br>
         END_SCHEMA;&nbsp;&nbsp;--&nbsp;sketch_schema<br></code></body>
</HTML>